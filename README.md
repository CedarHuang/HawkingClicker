# HawkingClicker
可通过快捷键触发鼠标或键盘点按、长按、连点、可编程的点击器。

## 快速开始
* 点击`+`按钮，添加配置。
* 点击`-`按钮，删除配置。
* 点击`↑`按钮，上移配置。
* 点击`↓`按钮，下移配置。
* 点击`⚙`按钮，打开`配置文件所在路径`。

## 配置参数
* `范围`：当活跃窗口的信息与配置相匹配时，才能通过热键触发。格式为`[进程名][:窗口名]`，使用 Unix shell 风格进行匹配，若配置为
    * `进程名`：则只匹配进程名。
    * `:窗口名`：则只匹配窗口名。
    * `进程名:窗口名`：则同时匹配进程名和窗口名。
    * 使用`*`匹配任意字符，使用`?`匹配单个字符。
    * 当范围配置为`*`时，匹配所有窗口。
* `位置`：触发时鼠标点击的位置，当配置为`(-1, -1)`时，点击鼠标当前所在位置。
* `类型`：触发时按键的操作类型，可选值为
    * `Click`：点击一次按键。
    * `Press`：按下按键，再次触发时松开按键。
    * `Multi`：连续点击按键，过程中再次触发则提前终止。
    * `Script`：自定义用户脚本。
* `按键`: 触发时操作的按键，可选值为
    * `Left`：鼠标左键。
    * `Right`：鼠标右键。
    * 其余值皆认为是其对应的键盘按键。
    * 当`类型`为`Script`时，表示脚本相对路径，且不需携带`.py`后缀，脚本根路径位于`配置文件所在路径/scripts`。
* `热键`：按下热键触发按键操作。
* `频率`：`类型 - Multi`限定配置，连续点击按键的频率，单位为`ms`。
* `次数`：`类型 - Multi`限定配置，连续点击按键的次数，当配置为`-1`时，将持续点击，直至再次触发时终止。
* `状态`：配置是否启用，可选值为
    * `Enable`：启用配置。
    * `Disable`：禁用配置。

## API文档
> 以`src/api.py`内容为准

- `init()`  
  首次调用返回True，后续调用返回False  
  参数: 无  
  返回: bool  

- `sleep(ms)`  
  暂停脚本执行指定毫秒数  
  参数: ms (float/int) - 暂停的毫秒数  
  返回: 无  

- `exit(code=0)`  
  终止当前脚本执行  
  参数: code (int) - 退出代码，默认为0  
  返回: 无 (抛出ScriptExit异常)  

- `quit()`  
  exit()函数的别名  

- `foreground()`  
  获取当前前台窗口信息  
  参数: 无  
  返回: tuple (process_name, window_title)  

- `position(x=-1, y=-1)`  
  获取鼠标位置  
  参数:  
    - x (int) - X坐标，-1表示当前X坐标  
    - y (int) - Y坐标，-1表示当前Y坐标  
  返回: tuple (x, y)  

- `click(button, x=-1, y=-1)`  
  模拟鼠标/键盘点击  
  参数:  
    - button (str) - 按钮/按键名称  
    - x (int) - 鼠标X坐标，-1表示当前位置  
    - y (int) - 鼠标Y坐标，-1表示当前位置  
  返回: 无  

- `down(button, x=-1, y=-1)`  
  模拟按下鼠标/键盘按键  
  参数: 同click()  
  返回: 无  

- `up(button, x=-1, y=-1)`  
  模拟释放鼠标/键盘按键  
  参数: 同click()  
  返回: 无  

## 常见问题
* 如果活跃窗口以管理员身份运行，则同样需要以管理员身份运行本程序，否则不会生效。
* 如果不知道窗口的进程名，没关系，使用我们的隐藏功能，将`范围`配置为`CHECK_WINDOW`，在需要探知的窗口中触发该配置后，`位置`将显示为`(进程名, 窗口名)`。
